<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Linear congruential generator | Pseudo Random Number Generators in R</title>
  <meta name="description" content="3 Linear congruential generator | Pseudo Random Number Generators in R" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Linear congruential generator | Pseudo Random Number Generators in R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Linear congruential generator | Pseudo Random Number Generators in R" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="middle-square.html"/>
<link rel="next" href="lagged-fibonacci-generator.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Motivation and Background</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#random-numbers"><i class="fa fa-check"></i><b>1.1</b> Random Numbers!</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#types-of-random-number-generators"><i class="fa fa-check"></i><b>1.2</b> Types of Random Number Generators</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="middle-square.html"><a href="middle-square.html"><i class="fa fa-check"></i><b>2</b> Middle-Square</a></li>
<li class="chapter" data-level="3" data-path="linear-congruential-generator.html"><a href="linear-congruential-generator.html"><i class="fa fa-check"></i><b>3</b> Linear congruential generator</a></li>
<li class="chapter" data-level="4" data-path="lagged-fibonacci-generator.html"><a href="lagged-fibonacci-generator.html"><i class="fa fa-check"></i><b>4</b> Lagged Fibonacci generator</a></li>
<li class="chapter" data-level="5" data-path="creating-other-distributions.html"><a href="creating-other-distributions.html"><i class="fa fa-check"></i><b>5</b> Creating other distributions</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Pseudo Random Number Generators in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-congruential-generator" class="section level1">
<h1><span class="header-section-number">3</span> Linear congruential generator</h1>
<p>We clearly need a better PRNG than middle-square if we want to have any hope of simulating random events. Luckily there have been many new ideas since 1949. Today, the most widely used general purpose PRNG is called the Mersenne Twister. It was developed in 1997 by Makoto Matsumoto Takuji Nishimura to overcome the flaws of the old PRNGs. This particular algorithm is used as the default PRNG in python, r, c++, and many more programming languages. The Mersenne Twister is based of of a simpler algorithm called a “Linear congruential generator” which we will look at</p>
<p>The algorithim takes in <em>4</em> inputs (as opposed to just the 1 that middle-square did). the inputs are :
- <em>m</em> the modulus
- <em>a</em> the multiplier
- <em>c</em> the increment
- <em>X_0</em> the seed</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linear-congruential-generator.html#cb4-1"></a>LCG &lt;-<span class="st"> </span><span class="cf">function</span>(m, a, c, X_<span class="dv">0</span>){</span>
<span id="cb4-2"><a href="linear-congruential-generator.html#cb4-2"></a>  <span class="kw">return</span>((a <span class="op">*</span><span class="st"> </span>X_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>c) <span class="op">%%</span><span class="st"> </span>m)</span>
<span id="cb4-3"><a href="linear-congruential-generator.html#cb4-3"></a>}</span></code></pre></div>
<p>With this method, we want to pick a large value for m, such as 2^32</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linear-congruential-generator.html#cb5-1"></a>m &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">^</span><span class="dv">32</span></span>
<span id="cb5-2"><a href="linear-congruential-generator.html#cb5-2"></a>a &lt;-<span class="st"> </span><span class="dv">123</span></span>
<span id="cb5-3"><a href="linear-congruential-generator.html#cb5-3"></a>c &lt;-<span class="st"> </span><span class="dv">4298</span></span>
<span id="cb5-4"><a href="linear-congruential-generator.html#cb5-4"></a>X_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="dv">3123</span></span>
<span id="cb5-5"><a href="linear-congruential-generator.html#cb5-5"></a></span>
<span id="cb5-6"><a href="linear-congruential-generator.html#cb5-6"></a><span class="kw">LCG</span>(m, a, c, X_<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 388427</code></pre>
<p>lets look at a distribution and plot it</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linear-congruential-generator.html#cb7-1"></a>results &lt;-<span class="st"> </span>X_<span class="dv">0</span></span>
<span id="cb7-2"><a href="linear-congruential-generator.html#cb7-2"></a></span>
<span id="cb7-3"><a href="linear-congruential-generator.html#cb7-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</span>
<span id="cb7-4"><a href="linear-congruential-generator.html#cb7-4"></a>  X_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">LCG</span>(m, a, c, X_<span class="dv">0</span>)</span>
<span id="cb7-5"><a href="linear-congruential-generator.html#cb7-5"></a>  results &lt;-<span class="st"> </span><span class="kw">c</span>(results, X_<span class="dv">0</span>)</span>
<span id="cb7-6"><a href="linear-congruential-generator.html#cb7-6"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linear-congruential-generator.html#cb8-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb8-2"><a href="linear-congruential-generator.html#cb8-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(results))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Wow, much better than the middle square. Notice how there isn’t an obvious pattern that got repeated. This means that this algorithm has a much higher period, which is one of the main ways to determine how “good” as PRNG is.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="middle-square.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lagged-fibonacci-generator.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
